# 04 Week2 实验与作业

## 实验 1：顺序 vs gather

文件：`src/week2_01_gather_vs_sequential.py`

要求：

1. 调整任务数量和单任务耗时。
2. 记录顺序执行与并发执行总耗时。
3. 总结：什么时候并发收益明显。

## 实验 2：超时与取消

文件：`src/week2_02_timeout_and_cancel.py`

要求：

1. 把 timeout 改小，触发超时。
2. 显式取消一个长任务。
3. 在任务内部清理资源（`finally`）。

## 实验 3：限流

文件：`src/week2_03_semaphore_limit.py`

要求：

1. 分别设置并发上限 1/3/10。
2. 观察总耗时变化。
3. 解释“吞吐 vs 资源占用”的折中。

## 实验 4：流水线与背压

文件：`src/week2_04_queue_pipeline.py`

要求：

1. 把 `Queue(maxsize=...)` 改小到 1。
2. 观察生产者是否被阻塞。
3. 使用哨兵值优雅关闭消费者。

## 实验 5：锁与竞态

文件：`src/week2_05_lock_race_condition.py`

要求：

1. 先跑“无锁版本”。
2. 再跑“有锁版本”。
3. 对比最终计数是否稳定。

## 作业

做一个“并发下载器模拟器”（无需真实网络）：

1. 100 个任务，任务耗时随机。
2. 并发上限 10。
3. 每个任务超时 0.8 秒，超时重试 1 次。
4. 输出成功数、失败数、平均耗时。
