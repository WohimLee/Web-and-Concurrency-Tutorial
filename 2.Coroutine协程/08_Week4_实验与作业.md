# 08 Week4 实验与作业

## 实验 1：优雅退出

文件：`src/week4_01_graceful_shutdown.py`

要求：

1. 模拟服务运行中接收停止信号。
2. 观察任务取消后的清理日志。
3. 确认事件循环内无残留任务。

## 实验 2：TaskGroup 故障传播

文件：`src/week4_02_taskgroup_service.py`

要求：

1. 让一个子任务故意报错。
2. 观察其他子任务是否被自动取消。
3. 分析结构化并发的收益。

## 实验 3：CPU 任务隔离

文件：`src/week4_04_cpu_bound_executor.py`

要求：

1. 在协程中直接跑 CPU 密集函数（反例）。
2. 改成 `run_in_executor` 或 `to_thread`。
3. 对比事件循环是否被阻塞。

## 作业

实现一个“异步工作器服务骨架”：

1. 启动时创建 3 类后台任务（拉取、处理、上报）。
2. 任意任务失败时触发整体关闭。
3. 退出时完成资源清理并打印汇总指标。
4. 给关键逻辑写 2 个 pytest-asyncio 测试。
